{% extends "base.html" %}
{% block 'taskdes' %}
The task is to get the data from api and create a pie chart that will state the
positive contribution of each and every state in the country.
{% endblock 'taskdes' %}
{% block 'content' %}
<div class="row">
  <div class="col-md-8">

    <canvas id="myChart"></canvas>

  </div>
  <div class="col-md-4">

  <div style="margin-top:50%">
    <center>
    <h1 style= "background: -webkit-linear-gradient(#00008B, 	#DDA0DD);-webkit-background-clip: text;-webkit-text-fill-color: transparent;">#SatewiseContribution</h1>
    <blockquote style="color:#DDA0DD;" >
      this pie chart shows the contribution of all the states in spreading COVID19
    </blockquote>
    </center>
  </div>

  </div>
</div>


{% endblock 'content' %}

{% block 'script' %}
<script type="text/javascript">
  url = "/api/get_data/res2?format=json";
  function getRandomColorHex() {
   var hex = "0123456789ABCDEF",
       color = "#";
   for (var i = 1; i <= 6; i++) {
     color += hex[Math.floor(Math.random() * 16)];
   }
   return color;
 }
  function create_pie_chart(labels,legend,pp){
  var ctx = document.getElementById('myChart').getContext('2d');
  var chart = new Chart(ctx, {
    // The type of chart we want to create
    type: 'pie',

    // The data for our dataset
    data: {
        labels: labels,
        datasets: [{
            label: "State Contribution in Spreading COVID19",
            backgroundColor: [
                              getRandomColorHex(),getRandomColorHex(),getRandomColorHex(),
                              getRandomColorHex(),getRandomColorHex(),getRandomColorHex(),
                              getRandomColorHex(),getRandomColorHex(),getRandomColorHex(),
                              getRandomColorHex(),getRandomColorHex(),getRandomColorHex(),
                              getRandomColorHex(),getRandomColorHex(),getRandomColorHex(),
                              getRandomColorHex(),getRandomColorHex(),getRandomColorHex(),
                              getRandomColorHex(),getRandomColorHex(),getRandomColorHex(),
                              getRandomColorHex(),getRandomColorHex(),getRandomColorHex(),
                              getRandomColorHex(),getRandomColorHex(),getRandomColorHex()
                              ],
        // borderColor: 'rgb(0, 0, 0)',
            data:pp,
        }]
    },
    legend:{
      position:'left',
      labels:legend,
    },

    // Configuration options go here
    options: {}
});
}

  $(document).ready(function(){
    $.get(url,function(data,status){
      state = data.state
      labels = data.labels
      countp = data.count_of_people
      pp = data.percentage_people
      create_pie_chart(labels,state,pp)

    });


  });

</script>
{% endblock 'script' %}
